doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title= title
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet")
    link(rel="stylesheet" href="/css/reports.css")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js")

  body
    // Navbar
    .navbar-custom.d-flex.justify-content-between.align-items-center.p-2.bg-dark.text-white
      .d-flex.align-items-center
        a(href="/dashboard")
          img(src='/images/mwf-logo.png' alt='MWF Logo' class='logo me-2')
        span.fs-4.text-white Mayondo Wood & Furniture Ltd
      .d-flex.align-items-center
        span.user-role.me-3 Manager
        a.btn.btn-sm.btn-light(href="/dashboard") Dashboard

    main.container.mt-4
      h2.mb-4 Reports

      // Sales Report
      .card.card-custom.mb-5
        .card-body
          h4.mb-3 Sales Report
          .d-flex.mb-3.justify-content-between.align-items-center
            .d-flex
              input#salesSearch.form-control.form-control-sm(type="text" placeholder="Search sales...")
            .btn-group
              button.btn.btn-sm.btn-success.me-2(onclick="exportTableToExcel('salesTable','Sales_Report')") Export Excel
              button.btn.btn-sm.btn-danger(onclick="exportTableToPDF('salesTable','Sales Report')") Export PDF
          table#salesTable.table.table-striped.table-bordered.table-hover
            thead.table-green
              tr
                th(scope="col") #
                th(scope="col") Customer
                th(scope="col") Product
                th(scope="col") Unit Price
                th(scope="col") Quantity
                th(scope="col") Total Price
                th(scope="col") Payment Type
                th(scope="col") Transport
                th(scope="col") Agent
                th(scope="col") Date
            tbody
              each sale, i in sales
                tr
                  td= i + 1
                  td= sale.customerName
                  //- td= sale.product
                  td= sale.product && sale.product.name ? sale.product.name : 'N/A'
                  td= sale.unitPrice
                  td= sale.quantity
                  td= sale.totalPrice
                  td= sale.paymentType
                  td= sale.transport ? 'Yes' : 'No'
                  td= sale.agent && sale.agent.fullName ? sale.agent.fullName : 'N/A'
                  td= moment(sale.date).format('YYYY-MM-DD')

      // Stock Adjustment Report
      .card.card-custom
        .card-body
          h4.mb-3 Stock Adjustment Report
          .d-flex.mb-3.justify-content-between.align-items-center
            .d-flex
              input#stockSearch.form-control.form-control-sm(type="text" placeholder="Search stock adjustments...")
            .btn-group
              button.btn.btn-sm.btn-success.me-2(onclick="exportTableToExcel('stockTable','Stock_Adjustments')") Export Excel
              button.btn.btn-sm.btn-danger(onclick="exportTableToPDF('stockTable','Stock Adjustments')") Export PDF
          table#stockTable.table.table-striped.table-bordered.table-hover
            thead.table-green
              tr
                th(scope="col") #
                th(scope="col") Product name
                th(scope="col") Type
                th(scope="col") Supplier
                th(scope="col") Quantity
                th(scope="col") Cost (UGX)
                th(scope="col") Price (UGX)
                th(scope="col") Quality
                th(scope="col") Last Update
                th(scope="col") Reason
                th(scope="col") Adjusted By
            tbody
              each adj, j in stockAdjustments
                tr
                  td= j + 1
                  td= adj.name
                  td= adj.type
                  td= adj.supplier
                  td= adj.quantity
                  td= adj.cost
                  td= adj.price
                  td= adj.quality
                  td= moment(adj.lastUpdate).format('YYYY-MM-DD')
                  td= adj.reason
                  td= adj.adjusted_by

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js")
    script(src="/js/reports.js")

    