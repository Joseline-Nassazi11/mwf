doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title MWF - Reports
  link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css' rel='stylesheet')
  link(rel='stylesheet' href='/css/style.css')
  // JS Libraries for Export
  script(src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js')
// Sidebar
.sidebar
  h2 MWF
  a(href='dashboard.html') Dashboard
  a(href='products.html') Products
  a(href='sales.html') Sales
  a(href='suppliers.html') Suppliers
  a.active(href='reports.html') Reports
// Navbar
.navbar-custom.d-flex.justify-content-between.align-items-center
  span Mayondo Wood &amp; Furniture Ltd
  span.user-role Manager
// Content
.content
  h2 Reports
  // Sales Report
  .card.card-custom.mb-4
    .card-body
      h4 Sales Report
      button.btn.btn-sm.btn-success.mb-2(onclick="exportTableToExcel('salesTable','Sales_Report')") Export Excel
      button.btn.btn-sm.btn-danger.mb-2(onclick="exportTableToPDF('salesTable','Sales Report')") Export PDF
      table#salesTable.table.table-striped
        thead.table-green
          tr
            th #
            th Date
            th Customer
            th Product
            th Quantity
            th Total Price
            th Payment Type
            th Sales Agent
        tbody
          tr
            td 1
            td 2025-09-10
            td XYZ Constructions
            td Timber
            td 50
            td 10,000,000
            td Cash
            td Sarah
  // Stock Adjustment Report
  .card.card-custom
    .card-body
      h4 Stock Adjustment Report
      button.btn.btn-sm.btn-success.mb-2(onclick="exportTableToExcel('stockTable','Stock_Adjustments')") Export Excel
      button.btn.btn-sm.btn-danger.mb-2(onclick="exportTableToPDF('stockTable','Stock Adjustments')") Export PDF
      table#stockTable.table.table-striped
        thead.table
          tr
            th #
            th Date
            th Product
            th Adjustment Type
            th Quantity
            th Reason
            th Adjusted By
        tbody
          tr
            td 1
            td 2025-09-10
            td Timber
            td Increase
            td +30
            td New delivery
            td Manager
          tr
            td 2
            td 2025-09-09
            td Dining Table
            td Decrease
            td -2
            td Damaged items
            td John (Attendant)
// Export JS
script.
  function exportTableToExcel(tableID, filename = '') {
  var wb = XLSX.utils.table_to_book(document.getElementById(tableID), { sheet: "Sheet1" });
  XLSX.writeFile(wb, filename + ".xlsx");
  }
  function exportTableToPDF(tableID, title) {
  const { jsPDF } = window.jspdf;
  var doc = new jsPDF();
  doc.text(title, 14, 20);
  doc.autoTable({ html: '#' + tableID, startY: 25 });
  doc.save(title + ".pdf");
  }
// Bootstrap JS
script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js')
